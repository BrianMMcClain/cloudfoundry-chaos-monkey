{"note":"Don't delete this file! It's used internally to help with page regeneration.","tagline":"Chaos Monkey style service for Cloud Foundry","name":"Cloud Foundry Chaos Monkey","body":"#cloudfoundry-chaos-monkey\r\n\r\nChaos Monkey style service for Cloud Foundry\r\n\r\n##Using Cloud Foundry Chaos Monkey\r\n\r\nFirst off, grab the Cloud Foundry Chaos Monkey gem\r\n\r\n```gem install cfcm```\r\n\r\nand then unleash the monkey! \r\n\r\n### Soft Mode\r\nSoft mode will simply remove/add instances at random. This uses the standard VMC APIs and you can specify the minimum and maximum number of instances the app may have.\r\n\r\nIn this example, we'll use CFCM on an application named `myapp`, keeping between 2 and 5 instances. We want CFCM to have a 30% chance of adding or removing an instance every 10 seconds. Adding and removeing instances is known as \"soft mode\", that is, this is equvilant to doing \"vmc instane [app] -1\".\r\n\r\n```cfcm soft [email] [password] myapp --min 2 --max 5 -p 30 -f 10```\r\n\r\n### Hard Mode\r\n\r\nHard mode gets a bit more bananas. BOSH-inspired, there is an IaaS-layer shim that sits between CFCM and your virtual machines. Currently, the following IaaS layers are supported...\r\n\r\n- vSphere\r\n\r\nand the following are planned...\r\n\r\n- AWS\r\n- OpenStack\r\n- BOSH (I realize this is a bit odd, but this will allow some interesting things in addition to straight IaaS)\r\n\r\nAs with BOSH, my goal is to allow the community to add their on IaaS layer. There's simply two commands that will be needed though; Power On and Power Off\r\n\r\nThere are two files that will be needed to run Hard Mode, a config file and an input file. The config file will contain the configuration specific to the IaaS you're targeting. The input file will list the VMs that are valid targets for CFCM. For vSphere, an example ```config.yml``` file would look like...\r\n\r\n<pre>\r\nhost: 127.0.0.1\r\nuser: john_doe\r\npassword: p@ssw0rd\r\ndatacenter: Monkey Island\r\n</pre>\r\n\r\nand a sample ```input.list``` file would look like...\r\n\r\n<pre>\r\ncf-cfcm-testing-dea-001\r\ncf-cfcm-testing-dea-002\r\ncf-cfcm-testing-dea-003\r\ncf-cfcm-testing-dea-004\r\ncf-cfcm-testing-dea-005\r\n</pre>\r\n\r\nNote: These don't JUST have to be DEAs. Really, CFCM could be used to rip VMs out from any distributed systems. This could be other pieces of Cloud Foundry (Service Gateways, Cloud Controllers, Routers, etc.) or for something completely unrelated to Cloud Foundry (AD servers? Replica database servers?)\r\n\r\nThen to unleash the monkey on your infrastructure, attempting to hit the VMs every 10 seconds with a 30% chance of taking out a VM, run...\r\n\r\n```cfcm hard --iaas vsphere -c config.yml -i input.list -f 10 -p 30```\r\n\r\n## To-Do\r\n\r\n- Implement the remaining IaaS layers\r\n- Provide a proper interface for the community to insert an IaaS layer\r\n- Add the ability to specify min/max VMs to be powered on for Hard Mode, including if we should power VMs back on (i.e. We shut down a DEA last time, let's power it back on and power off a Router)","google":""}